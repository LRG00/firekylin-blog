/**
  * UPYUN js-sdk 3.3.9
  * (c) 2019
  * @license MIT
  */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("axios")):"function"==typeof define&&define.amd?define(["axios"],e):t.upyun=e(t.axios)}(this,function(f){"use strict";f="default"in f?f.default:f;var s="undefined"!=typeof window&&("undefined"==typeof process||"browser"===process.title),u=1048576,p=function(t){return!!t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof t.then};var E="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(t,e){return t(e={exports:{}},e.exports),e.exports}var N=t(function(T,U){!function(t){var e=U&&!U.nodeType&&U,r=T&&!T.nodeType&&T,n="object"==typeof E&&E;n.global!==n&&n.window!==n&&n.self!==n||(t=n);var o,i,m=2147483647,g=36,b=1,x=26,a=38,s=700,w=72,A=128,C="-",u=/^xn--/,h=/[^\x20-\x7E]/,l=/[\x2E\u3002\uFF0E\uFF61]/g,c={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},f=g-b,k=Math.floor,S=String.fromCharCode;function j(t){throw RangeError(c[t])}function p(t,e){for(var r=t.length,n=[];r--;)n[r]=e(t[r]);return n}function v(t,e){var r=t.split("@"),n="";return 1<r.length&&(n=r[0]+"@",t=r[1]),n+p((t=t.replace(l,".")).split("."),e).join(".")}function O(t){for(var e,r,n=[],o=0,i=t.length;o<i;)55296<=(e=t.charCodeAt(o++))&&e<=56319&&o<i?56320==(64512&(r=t.charCodeAt(o++)))?n.push(((1023&e)<<10)+(1023&r)+65536):(n.push(e),o--):n.push(e);return n}function P(t){return p(t,function(t){var e="";return 65535<t&&(e+=S((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+=S(t)}).join("")}function q(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function I(t,e,r){var n=0;for(t=r?k(t/s):t>>1,t+=k(t/e);f*x>>1<t;n+=g)t=k(t/f);return k(n+(f+1)*t/(t+a))}function d(t){var e,r,n,o,i,a,s,u,h,l,c,f=[],p=t.length,v=0,d=A,y=w;for((r=t.lastIndexOf(C))<0&&(r=0),n=0;n<r;++n)128<=t.charCodeAt(n)&&j("not-basic"),f.push(t.charCodeAt(n));for(o=0<r?r+1:0;o<p;){for(i=v,a=1,s=g;p<=o&&j("invalid-input"),c=t.charCodeAt(o++),(g<=(u=c-48<10?c-22:c-65<26?c-65:c-97<26?c-97:g)||u>k((m-v)/a))&&j("overflow"),v+=u*a,!(u<(h=s<=y?b:y+x<=s?x:s-y));s+=g)a>k(m/(l=g-h))&&j("overflow"),a*=l;y=I(v-i,e=f.length+1,0==i),k(v/e)>m-d&&j("overflow"),d+=k(v/e),v%=e,f.splice(v++,0,d)}return P(f)}function y(t){var e,r,n,o,i,a,s,u,h,l,c,f,p,v,d,y=[];for(f=(t=O(t)).length,e=A,i=w,a=r=0;a<f;++a)(c=t[a])<128&&y.push(S(c));for(n=o=y.length,o&&y.push(C);n<f;){for(s=m,a=0;a<f;++a)e<=(c=t[a])&&c<s&&(s=c);for(s-e>k((m-r)/(p=n+1))&&j("overflow"),r+=(s-e)*p,e=s,a=0;a<f;++a)if((c=t[a])<e&&++r>m&&j("overflow"),c==e){for(u=r,h=g;!(u<(l=h<=i?b:i+x<=h?x:h-i));h+=g)d=u-l,v=g-l,y.push(S(q(l+d%v,0))),u=k(d/v);y.push(S(q(u,0))),i=I(r,p,n==o),r=0,++n}++r,++e}return y.join("")}if(o={version:"1.3.2",ucs2:{decode:O,encode:P},decode:d,encode:y,toASCII:function(t){return v(t,function(t){return h.test(t)?"xn--"+y(t):t})},toUnicode:function(t){return v(t,function(t){return u.test(t)?d(t.slice(4).toLowerCase()):t})}},e&&r)if(T.exports==e)r.exports=o;else for(i in o)o.hasOwnProperty(i)&&(e[i]=o[i]);else t.punycode=o}(E)}),B={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}};function r(t,e,r,n){e=e||"&",r=r||"=";var o={};if("string"!=typeof t||0===t.length)return o;var i=/\+/g;t=t.split(e);var a=1e3;n&&"number"==typeof n.maxKeys&&(a=n.maxKeys);var s,u,h=t.length;0<a&&a<h&&(h=a);for(var l=0;l<h;++l){var c,f,p,v,d=t[l].replace(i,"%20"),y=d.indexOf(r);f=0<=y?(c=d.substr(0,y),d.substr(y+1)):(c=d,""),p=decodeURIComponent(c),v=decodeURIComponent(f),s=o,u=p,Object.prototype.hasOwnProperty.call(s,u)?Array.isArray(o[p])?o[p].push(v):o[p]=[o[p],v]:o[p]=v}return o}function i(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}}function n(r,n,o,t){return n=n||"&",o=o||"=",null===r&&(r=void 0),"object"==typeof r?Object.keys(r).map(function(t){var e=encodeURIComponent(i(t))+o;return Array.isArray(r[t])?r[t].map(function(t){return e+encodeURIComponent(i(t))}).join(n):e+encodeURIComponent(i(r[t]))}).join(n):t?encodeURIComponent(i(t))+o+encodeURIComponent(i(r)):""}function e(t,e){return d(t,!1,!0).resolve(e)}function o(t,e){return t?d(t,!1,!0).resolveObject(e):e}function a(t){return B.isString(t)&&(t=d(t)),t instanceof O?t.format():O.prototype.format.call(t)}var z=t(function(t,e){e.decode=e.parse=r,e.encode=e.stringify=n}),h=d,l=O;function O(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var R=/^([a-z0-9.+-]+:)/i,c=/:[0-9]*$/,M=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,v=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),F=["'"].concat(v),_=["%","/","?",";","#"].concat(F),L=["/","?","#"],D=/^[+a-z0-9A-Z_-]{0,63}$/,H=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Z={javascript:!0,"javascript:":!0},G={javascript:!0,"javascript:":!0},J={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function d(t,e,r){if(t&&B.isObject(t)&&t instanceof O)return t;var n=new O;return n.parse(t,e,r),n}O.prototype.parse=function(t,e,r){if(!B.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var n=t.indexOf("?"),o=-1!==n&&n<t.indexOf("#")?"?":"#",i=t.split(o);i[0]=i[0].replace(/\\/g,"/");var a=t=i.join(o);if(a=a.trim(),!r&&1===t.split("#").length){var s=M.exec(a);if(s)return this.path=a,this.href=a,this.pathname=s[1],s[2]?(this.search=s[2],this.query=e?z.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var u=R.exec(a);if(u){var h=(u=u[0]).toLowerCase();this.protocol=h,a=a.substr(u.length)}if(r||u||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var l="//"===a.substr(0,2);!l||u&&G[u]||(a=a.substr(2),this.slashes=!0)}if(!G[u]&&(l||u&&!J[u])){for(var c,f,p=-1,v=0;v<L.length;v++){-1!==(d=a.indexOf(L[v]))&&(-1===p||d<p)&&(p=d)}-1!==(f=-1===p?a.lastIndexOf("@"):a.lastIndexOf("@",p))&&(c=a.slice(0,f),a=a.slice(f+1),this.auth=decodeURIComponent(c)),p=-1;for(v=0;v<_.length;v++){var d;-1!==(d=a.indexOf(_[v]))&&(-1===p||d<p)&&(p=d)}-1===p&&(p=a.length),this.host=a.slice(0,p),a=a.slice(p),this.parseHost(),this.hostname=this.hostname||"";var y="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!y)for(var m=this.hostname.split(/\./),g=(v=0,m.length);v<g;v++){var b=m[v];if(b&&!b.match(D)){for(var x="",w=0,A=b.length;w<A;w++)127<b.charCodeAt(w)?x+="x":x+=b[w];if(!x.match(D)){var C=m.slice(0,v),k=m.slice(v+1),S=b.match(H);S&&(C.push(S[1]),k.unshift(S[2])),k.length&&(a="/"+k.join(".")+a),this.hostname=C.join(".");break}}}255<this.hostname.length?this.hostname="":this.hostname=this.hostname.toLowerCase(),y||(this.hostname=N.toASCII(this.hostname));var j=this.port?":"+this.port:"",O=this.hostname||"";this.host=O+j,this.href+=this.host,y&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==a[0]&&(a="/"+a))}if(!Z[h])for(v=0,g=F.length;v<g;v++){var P=F[v];if(-1!==a.indexOf(P)){var q=encodeURIComponent(P);q===P&&(q=escape(P)),a=a.split(P).join(q)}}var I=a.indexOf("#");-1!==I&&(this.hash=a.substr(I),a=a.slice(0,I));var T=a.indexOf("?");if(-1!==T?(this.search=a.substr(T),this.query=a.substr(T+1),e&&(this.query=z.parse(this.query)),a=a.slice(0,T)):e&&(this.search="",this.query={}),a&&(this.pathname=a),J[h]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){j=this.pathname||"";var U=this.search||"";this.path=j+U}return this.href=this.format(),this},O.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",r=this.pathname||"",n=this.hash||"",o=!1,i="";this.host?o=t+this.host:this.hostname&&(o=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&B.isObject(this.query)&&Object.keys(this.query).length&&(i=z.stringify(this.query));var a=this.search||i&&"?"+i||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||J[e])&&!1!==o?(o="//"+(o||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):o||(o=""),n&&"#"!==n.charAt(0)&&(n="#"+n),a&&"?"!==a.charAt(0)&&(a="?"+a),e+o+(r=r.replace(/[?#]/g,function(t){return encodeURIComponent(t)}))+(a=a.replace("#","%23"))+n},O.prototype.resolve=function(t){return this.resolveObject(d(t,!1,!0)).format()},O.prototype.resolveObject=function(t){if(B.isString(t)){var e=new O;e.parse(t,!1,!0),t=e}for(var r=new O,n=Object.keys(this),o=0;o<n.length;o++){var i=n[o];r[i]=this[i]}if(r.hash=t.hash,""===t.href)return r.href=r.format(),r;if(t.slashes&&!t.protocol){for(var a=Object.keys(t),s=0;s<a.length;s++){var u=a[s];"protocol"!==u&&(r[u]=t[u])}return J[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(t.protocol&&t.protocol!==r.protocol){if(!J[t.protocol]){for(var h=Object.keys(t),l=0;l<h.length;l++){var c=h[l];r[c]=t[c]}return r.href=r.format(),r}if(r.protocol=t.protocol,t.host||G[t.protocol])r.pathname=t.pathname;else{for(var f=(t.pathname||"").split("/");f.length&&!(t.host=f.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==f[0]&&f.unshift(""),f.length<2&&f.unshift(""),r.pathname=f.join("/")}if(r.search=t.search,r.query=t.query,r.host=t.host||"",r.auth=t.auth,r.hostname=t.hostname||t.host,r.port=t.port,r.pathname||r.search){var p=r.pathname||"",v=r.search||"";r.path=p+v}return r.slashes=r.slashes||t.slashes,r.href=r.format(),r}var d=r.pathname&&"/"===r.pathname.charAt(0),y=t.host||t.pathname&&"/"===t.pathname.charAt(0),m=y||d||r.host&&t.pathname,g=m,b=r.pathname&&r.pathname.split("/")||[],x=(f=t.pathname&&t.pathname.split("/")||[],r.protocol&&!J[r.protocol]);if(x&&(r.hostname="",r.port=null,r.host&&(""===b[0]?b[0]=r.host:b.unshift(r.host)),r.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===f[0]?f[0]=t.host:f.unshift(t.host)),t.host=null),m=m&&(""===f[0]||""===b[0])),y)r.host=t.host||""===t.host?t.host:r.host,r.hostname=t.hostname||""===t.hostname?t.hostname:r.hostname,r.search=t.search,r.query=t.query,b=f;else if(f.length)b||(b=[]),b.pop(),b=b.concat(f),r.search=t.search,r.query=t.query;else if(!B.isNullOrUndefined(t.search)){if(x)r.hostname=r.host=b.shift(),(S=!!(r.host&&0<r.host.indexOf("@"))&&r.host.split("@"))&&(r.auth=S.shift(),r.host=r.hostname=S.shift());return r.search=t.search,r.query=t.query,B.isNull(r.pathname)&&B.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!b.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var w=b.slice(-1)[0],A=(r.host||t.host||1<b.length)&&("."===w||".."===w)||""===w,C=0,k=b.length;0<=k;k--)"."===(w=b[k])?b.splice(k,1):".."===w?(b.splice(k,1),C++):C&&(b.splice(k,1),C--);if(!m&&!g)for(;C--;C)b.unshift("..");!m||""===b[0]||b[0]&&"/"===b[0].charAt(0)||b.unshift(""),A&&"/"!==b.join("/").substr(-1)&&b.push("");var S,j=""===b[0]||b[0]&&"/"===b[0].charAt(0);x&&(r.hostname=r.host=j?"":b.length?b.shift():"",(S=!!(r.host&&0<r.host.indexOf("@"))&&r.host.split("@"))&&(r.auth=S.shift(),r.host=r.hostname=S.shift()));return(m=m||r.host&&b.length)&&!j&&b.unshift(""),b.length?r.pathname=b.join("/"):(r.pathname=null,r.path=null),B.isNull(r.pathname)&&B.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=t.auth||r.auth,r.slashes=r.slashes||t.slashes,r.href=r.format(),r},O.prototype.parseHost=function(){var t=this.host,e=c.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)};var y={parse:h,resolve:e,resolveObject:o,format:a,Url:l},m=f.defaults.adapter;f.defaults.adapter=s?m:require("axios/lib/adapters/http");var g={readBlockAsync:function(n,o,i){return new Promise(function(t,e){var r=n.slice||n.mozSlice||n.webkitSlice;return r?t(r.call(n,o,i)):e(new Error("not support File type!"))})}};function A(t){return null!=t&&(j(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&j(t.slice(0,0))}(t)||!!t._isBuffer)}var b=function(t,e,i,s){function w(t,e){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}function A(t,e){return t<<e|t>>>32-e}function u(t,e){t[e>>5]|=128<<24-e%32,t[15+(e+64>>9<<4)]=e;for(var r,n,o,i,a,s=[80],u=1732584193,h=-271733879,l=-1732584194,c=271733878,f=-1009589776,p=0;p<t.length;p+=16){for(var v=u,d=h,y=l,m=c,g=f,b=0;b<80;b++){s[b]=b<16?t[p+b]:A(s[b-3]^s[b-8]^s[b-14]^s[b-16],1);var x=w(w(A(u,5),(o=h,i=l,a=c,(n=b)<20?o&i|~o&a:n<40?o^i^a:n<60?o&i|o&a|i&a:o^i^a)),w(w(f,s[b]),(r=b)<20?1518500249:r<40?1859775393:r<60?-1894007588:-899497514));f=c,c=l,l=A(h,30),h=u,u=x}u=w(u,v),h=w(h,d),l=w(l,y),c=w(c,m),f=w(f,g)}return[u,h,l,c,f]}function h(t){for(var e=[],r=(1<<s)-1,n=0;n<t.length*s;n+=s)e[n>>5]|=(t.charCodeAt(n/8)&r)<<32-s-n%32;return e}return i||(i="="),s||(s=8),function(t){for(var e="",r=0;r<4*t.length;r+=3)for(var n=(t[r>>2]>>8*(3-r%4)&255)<<16|(t[r+1>>2]>>8*(3-(r+1)%4)&255)<<8|t[r+2>>2]>>8*(3-(r+2)%4)&255,o=0;o<4;o++)8*r+6*o>32*t.length?e+=i:e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(n>>6*(3-o)&63);return e}(function(t,e){var r=h(t);16<r.length&&(r=u(r,t.length*s));for(var n=[16],o=[16],i=0;i<16;i++)n[i]=909522486^r[i],o[i]=1549556828^r[i];var a=u(n.concat(h(e)),512+e.length*s);return u(o.concat(a),672)}(t,e))},x=t(function(u,c){!function(t){var e=c,r=u&&u.exports==e&&u,n="object"==typeof E&&E;n.global!==n&&n.window!==n||(t=n);function o(t){this.message=t}(o.prototype=new Error).name="InvalidCharacterError";function h(t){throw new o(t)}var l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=/[\t\n\f\r ]/g,i={encode:function(t){t=String(t),/[^\0-\xFF]/.test(t)&&h("The string to be encoded contains characters outside of the Latin1 range.");for(var e,r,n,o,i=t.length%3,a="",s=-1,u=t.length-i;++s<u;)e=t.charCodeAt(s)<<16,r=t.charCodeAt(++s)<<8,n=t.charCodeAt(++s),a+=l.charAt((o=e+r+n)>>18&63)+l.charAt(o>>12&63)+l.charAt(o>>6&63)+l.charAt(63&o);return 2==i?(e=t.charCodeAt(s)<<8,r=t.charCodeAt(++s),a+=l.charAt((o=e+r)>>10)+l.charAt(o>>4&63)+l.charAt(o<<2&63)+"="):1==i&&(o=t.charCodeAt(s),a+=l.charAt(o>>2)+l.charAt(o<<4&63)+"=="),a},decode:function(t){var e=(t=String(t).replace(s,"")).length;e%4==0&&(e=(t=t.replace(/==?$/,"")).length),e%4!=1&&!/[^+a-zA-Z0-9/]/.test(t)||h("Invalid character: the string to be decoded is not correctly encoded.");for(var r,n,o=0,i="",a=-1;++a<e;)n=l.indexOf(t.charAt(a)),r=o%4?64*r+n:n,o++%4&&(i+=String.fromCharCode(255&r>>(-2*o&6)));return i},version:"0.1.0"};if(e&&!e.nodeType)if(r)r.exports=i;else for(var a in i)i.hasOwnProperty(a)&&(e[a]=i[a]);else t.base64=i}(E)}),w="3.3.9",C=t(function(t){var i,r;i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r={rotl:function(t,e){return t<<e|t>>>32-e},rotr:function(t,e){return t<<32-e|t>>>e},endian:function(t){if(t.constructor==Number)return 16711935&r.rotl(t,8)|4278255360&r.rotl(t,24);for(var e=0;e<t.length;e++)t[e]=r.endian(t[e]);return t},randomBytes:function(t){for(var e=[];0<t;t--)e.push(Math.floor(256*Math.random()));return e},bytesToWords:function(t){for(var e=[],r=0,n=0;r<t.length;r++,n+=8)e[n>>>5]|=t[r]<<24-n%32;return e},wordsToBytes:function(t){for(var e=[],r=0;r<32*t.length;r+=8)e.push(t[r>>>5]>>>24-r%32&255);return e},bytesToHex:function(t){for(var e=[],r=0;r<t.length;r++)e.push((t[r]>>>4).toString(16)),e.push((15&t[r]).toString(16));return e.join("")},hexToBytes:function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(parseInt(t.substr(r,2),16));return e},bytesToBase64:function(t){for(var e=[],r=0;r<t.length;r+=3)for(var n=t[r]<<16|t[r+1]<<8|t[r+2],o=0;o<4;o++)8*r+6*o<=8*t.length?e.push(i.charAt(n>>>6*(3-o)&63)):e.push("=");return e.join("")},base64ToBytes:function(t){t=t.replace(/[^A-Z0-9+\/]/gi,"");for(var e=[],r=0,n=0;r<t.length;n=++r%4)0!=n&&e.push((i.indexOf(t.charAt(r-1))&Math.pow(2,-2*n+8)-1)<<2*n|i.indexOf(t.charAt(r))>>>6-2*n);return e}},t.exports=r}),k={utf8:{stringToBytes:function(t){return k.bin.stringToBytes(unescape(encodeURIComponent(t)))},bytesToString:function(t){return decodeURIComponent(escape(k.bin.bytesToString(t)))}},bin:{stringToBytes:function(t){for(var e=[],r=0;r<t.length;r++)e.push(255&t.charCodeAt(r));return e},bytesToString:function(t){for(var e=[],r=0;r<t.length;r++)e.push(String.fromCharCode(t[r]));return e.join("")}}},S=k;function j(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}var P=t(function(t){var m,g,b,x,w;m=C,g=S.utf8,b=A,x=S.bin,(w=function(t,e){t.constructor==String?t=e&&"binary"===e.encoding?x.stringToBytes(t):g.stringToBytes(t):b(t)?t=Array.prototype.slice.call(t,0):Array.isArray(t)||(t=t.toString());for(var r=m.bytesToWords(t),n=8*t.length,o=1732584193,i=-271733879,a=-1732584194,s=271733878,u=0;u<r.length;u++)r[u]=16711935&(r[u]<<8|r[u]>>>24)|4278255360&(r[u]<<24|r[u]>>>8);r[n>>>5]|=128<<n%32,r[14+(64+n>>>9<<4)]=n;var h=w._ff,l=w._gg,c=w._hh,f=w._ii;for(u=0;u<r.length;u+=16){var p=o,v=i,d=a,y=s;i=f(i=f(i=f(i=f(i=c(i=c(i=c(i=c(i=l(i=l(i=l(i=l(i=h(i=h(i=h(i=h(i,a=h(a,s=h(s,o=h(o,i,a,s,r[u+0],7,-680876936),i,a,r[u+1],12,-389564586),o,i,r[u+2],17,606105819),s,o,r[u+3],22,-1044525330),a=h(a,s=h(s,o=h(o,i,a,s,r[u+4],7,-176418897),i,a,r[u+5],12,1200080426),o,i,r[u+6],17,-1473231341),s,o,r[u+7],22,-45705983),a=h(a,s=h(s,o=h(o,i,a,s,r[u+8],7,1770035416),i,a,r[u+9],12,-1958414417),o,i,r[u+10],17,-42063),s,o,r[u+11],22,-1990404162),a=h(a,s=h(s,o=h(o,i,a,s,r[u+12],7,1804603682),i,a,r[u+13],12,-40341101),o,i,r[u+14],17,-1502002290),s,o,r[u+15],22,1236535329),a=l(a,s=l(s,o=l(o,i,a,s,r[u+1],5,-165796510),i,a,r[u+6],9,-1069501632),o,i,r[u+11],14,643717713),s,o,r[u+0],20,-373897302),a=l(a,s=l(s,o=l(o,i,a,s,r[u+5],5,-701558691),i,a,r[u+10],9,38016083),o,i,r[u+15],14,-660478335),s,o,r[u+4],20,-405537848),a=l(a,s=l(s,o=l(o,i,a,s,r[u+9],5,568446438),i,a,r[u+14],9,-1019803690),o,i,r[u+3],14,-187363961),s,o,r[u+8],20,1163531501),a=l(a,s=l(s,o=l(o,i,a,s,r[u+13],5,-1444681467),i,a,r[u+2],9,-51403784),o,i,r[u+7],14,1735328473),s,o,r[u+12],20,-1926607734),a=c(a,s=c(s,o=c(o,i,a,s,r[u+5],4,-378558),i,a,r[u+8],11,-2022574463),o,i,r[u+11],16,1839030562),s,o,r[u+14],23,-35309556),a=c(a,s=c(s,o=c(o,i,a,s,r[u+1],4,-1530992060),i,a,r[u+4],11,1272893353),o,i,r[u+7],16,-155497632),s,o,r[u+10],23,-1094730640),a=c(a,s=c(s,o=c(o,i,a,s,r[u+13],4,681279174),i,a,r[u+0],11,-358537222),o,i,r[u+3],16,-722521979),s,o,r[u+6],23,76029189),a=c(a,s=c(s,o=c(o,i,a,s,r[u+9],4,-640364487),i,a,r[u+12],11,-421815835),o,i,r[u+15],16,530742520),s,o,r[u+2],23,-995338651),a=f(a,s=f(s,o=f(o,i,a,s,r[u+0],6,-198630844),i,a,r[u+7],10,1126891415),o,i,r[u+14],15,-1416354905),s,o,r[u+5],21,-57434055),a=f(a,s=f(s,o=f(o,i,a,s,r[u+12],6,1700485571),i,a,r[u+3],10,-1894986606),o,i,r[u+10],15,-1051523),s,o,r[u+1],21,-2054922799),a=f(a,s=f(s,o=f(o,i,a,s,r[u+8],6,1873313359),i,a,r[u+15],10,-30611744),o,i,r[u+6],15,-1560198380),s,o,r[u+13],21,1309151649),a=f(a,s=f(s,o=f(o,i,a,s,r[u+4],6,-145523070),i,a,r[u+11],10,-1120210379),o,i,r[u+2],15,718787259),s,o,r[u+9],21,-343485551),o=o+p>>>0,i=i+v>>>0,a=a+d>>>0,s=s+y>>>0}return m.endian([o,i,a,s])})._ff=function(t,e,r,n,o,i,a){var s=t+(e&r|~e&n)+(o>>>0)+a;return(s<<i|s>>>32-i)+e},w._gg=function(t,e,r,n,o,i,a){var s=t+(e&n|r&~n)+(o>>>0)+a;return(s<<i|s>>>32-i)+e},w._hh=function(t,e,r,n,o,i,a){var s=t+(e^r^n)+(o>>>0)+a;return(s<<i|s>>>32-i)+e},w._ii=function(t,e,r,n,o,i,a){var s=t+(r^(e|~n))+(o>>>0)+a;return(s<<i|s>>>32-i)+e},w._blocksize=16,w._digestsize=16,t.exports=function(t,e){if(null==t)throw new Error("Illegal argument "+t);var r=m.wordsToBytes(w(t,e));return e&&e.asBytes?r:e&&e.asString?x.bytesToString(r):m.bytesToHex(r)}});function q(t,e){var r=e.method,n=e.path,o=[r,encodeURI(n)];["date","policy","contentMd5"].forEach(function(t){e[t]&&o.push(e[t])});var i=b(t.password,o.join("&"));return"UPYUN "+t.operatorName+":"+i}function I(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var T={genSign:q,getHeaderSign:function(t,e,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,o=(new Date).toGMTString();return{Authorization:q(t,{method:e,path:r="/"+t.serviceName+r,date:o,contentMd5:n}),"X-Date":o}},getPolicyAndAuthorization:function(t,e){if(e.service=t.serviceName,void 0===e["save-key"])throw new Error("upyun - calclate body sign need save-key");void 0===e.expiration&&(e.expiration=parseInt(new Date/1e3+1800,10));var r=x.encode(JSON.stringify(e));return{policy:r,authorization:q(t,{method:"POST",path:"/"+t.serviceName,policy:r,contentMd5:e["content-md5"]})}},getPurgeHeaderSign:function(t,e){var r=(new Date).toGMTString(),n=e.join("\n"),o=P(n+"&"+t.serviceName+"&"+r+"&"+t.password);return{Authorization:"UpYun "+t.serviceName+":"+t.operatorName+":"+o,Date:r,"User-Agent":"Js-Sdk/"+w}}};function U(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var K=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return r}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")};function W(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(I(this,W),void 0===t.serviceName)throw new Error("upyun - must config serviceName");if("function"==typeof e&&(r=e,e={}),"function"!=typeof r&&s)throw new Error("upyun - must config a callback function getHeaderSign in client side");if(!s&&(void 0===t.operatorName||void 0===t.password))throw new Error("upyun - must config operateName and password in server side");var n=Object.assign({domain:"v0.api.upyun.com",protocol:"https"},e);this.endpoint=n.protocol+"://"+n.domain;var o=n.proxy;this.proxy=o,this.req=function(t,o,i){var e=(3<arguments.length&&void 0!==arguments[3]?arguments[3]:{}).proxy,r=f.create({baseURL:t+"/"+o.serviceName,maxRedirects:0,proxy:e});return r.interceptors.request.use(function(e){var t=e.method.toUpperCase(),r=y.resolve("/",e.url||"");0===r.indexOf(e.baseURL)&&(r=r.substring(e.baseURL.length)),e.url=encodeURI(e.url);var n=i(o,t,r,e.headers["Content-MD5"]);return(n=p(n)?n:Promise.resolve(n)).then(function(t){return e.headers.common=t,Promise.resolve(e)})},function(t){throw new Error("upyun - request failed: "+t.message)}),r.interceptors.response.use(function(t){return t},function(t){var e=t.response;if(void 0===e)throw t;if(404!==e.status)throw new Error("upyun - response error: "+t.message);return e}),r}(this.endpoint,t,r||$,{proxy:o}),this.bucket=t,this.service=t,s||this.setBodySignCallback(T.getPolicyAndAuthorization)}function Y(t){return 0===t.indexOf("x-upyun-meta-")}function $(){return T.getHeaderSign.apply(T,arguments)}function X(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"";I(this,X),this.bucketName=t,this.serviceName=this.bucketName,this.operatorName=e,this.password=P(r)}return{Client:(function(t,e,r){return e&&U(t.prototype,e),r&&U(t,r),t}(W,[{key:"setService",value:function(t){this.service=t,this.req.defaults.baseURL=this.endpoint+"/"+t.serviceName}},{key:"setBucket",value:function(t){return this.setService(t)}},{key:"setBodySignCallback",value:function(t){if("function"!=typeof t)throw new Error("upyun - getBodySign should be a function");this.bodySignCallback=t}},{key:"usage",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"/";return this.req.get(t+"?usage").then(function(t){var e=t.data;return Promise.resolve(e)})}},{key:"listDir",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"/",e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=e.limit,n=void 0===r?100:r,o=e.order,i=void 0===o?"asc":o,a=e.iter,s=void 0===a?"":a,u={};return 100!==n&&(u["x-list-limit"]=n),"asc"!==i&&(u["x-list-order"]=i),s&&(u["x-list-iter"]=s),this.req.get(t,{headers:u}).then(function(t){var e=t.data,r=t.headers;if(404===t.status)return!1;var n=r["x-upyun-list-iter"];if(!e)return Promise.resolve({files:[],next:n});var o=e.split("\n").map(function(t){var e=t.split("\t"),r=K(e,4),n=r[0],o=r[1],i=r[2],a=r[3];return{name:n,type:o,size:parseInt(i),time:parseInt(a)}});return Promise.resolve({files:o,next:n})})}},{key:"putFile",value:function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},n=["Content-MD5","Content-Length","Content-Type","Content-Secret","x-gmkerl-thumb"],o={},i={},a=!0,s=!1,u=void 0;try{for(var h,l=Object.keys(r)[Symbol.iterator]();!(a=(h=l.next()).done);a=!0){var c=h.value;i[c.toLowerCase()]=r[c]}}catch(t){s=!0,u=t}finally{try{!a&&l.return&&l.return()}finally{if(s)throw u}}var f=!0,p=!1,v=void 0;try{for(var d,y=Object.keys(i)[Symbol.iterator]();!(f=(d=y.next()).done);f=!0){var m=d.value;Y(m)&&i[m]?o[m]=i[m]:n.forEach(function(t){var e=t.toLowerCase(),r=i[e];r&&(o[t]=r)})}}catch(t){p=!0,v=t}finally{try{!f&&y.return&&y.return()}finally{if(p)throw v}}return this.req.put(t,e,{headers:o}).then(function(t){var r=t.headers;if(200!==t.status)return Promise.resolve(!1);var n={};return["x-upyun-width","x-upyun-height","x-upyun-file-type","x-upyun-frames"].forEach(function(t){var e=t.split("x-upyun-")[1];r[t]&&(n[e]=r[t],"file-type"!==e&&(n[e]=parseInt(n[e],10)))}),Promise.resolve(!(0<Object.keys(n).length)||n)})}},{key:"initMultipartUpload",value:function(t,e){var r=this,n=void 0,o=function(t){var e={},r=!0,n=!1,o=void 0;try{for(var i,a=Object.keys(t)[Symbol.iterator]();!(r=(i=a.next()).done);r=!0){var s=i.value;e[s.toLowerCase()]=t[s]}}catch(t){n=!0,o=t}finally{try{!r&&a.return&&a.return()}finally{if(n)throw o}}return e}(2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}),i=o["x-upyun-multi-type"];return i=s?(n=Promise.resolve(e.size),i||e.type):(n=g.getFileSizeAsync(e),i||g.getContentType(e)),n.then(function(n){return Object.assign(o,{"x-upyun-multi-disorder":!0,"x-upyun-multi-stage":"initiate","x-upyun-multi-length":n,"x-upyun-multi-type":i}),r.req.put(t,null,{headers:o}).then(function(t){var e=t.headers;if(204!==t.status)return Promise.resolve(!1);var r=e["x-upyun-multi-uuid"];return Promise.resolve({fileSize:n,partCount:Math.ceil(n/u),uuid:r})})})}},{key:"multipartUpload",value:function(e,r,n,o){var i=this,a=o*u;return(s?Promise.resolve(r.size):g.getFileSizeAsync(r)).then(function(t){var e=Math.min(a+u,t);return g.readBlockAsync(r,a,e)}).then(function(t){return i.req.put(e,t,{headers:{"x-upyun-multi-stage":"upload","x-upyun-multi-uuid":n,"x-upyun-part-id":o}}).then(function(t){var e=t.status;return Promise.resolve(204===e)})})}},{key:"completeMultipartUpload",value:function(t,e){return this.req.put(t,null,{headers:{"x-upyun-multi-stage":"complete","x-upyun-multi-uuid":e}}).then(function(t){var e=t.status;return Promise.resolve(204===e||201===e)})}},{key:"makeDir",value:function(t){return this.req.post(t,null,{headers:{folder:"true"}}).then(function(t){var e=t.status;return Promise.resolve(200===e)})}},{key:"headFile",value:function(t){return this.req.head(t).then(function(t){var r=t.headers;if(404===t.status)return Promise.resolve(!1);var n={"Content-Md5":r["content-md5"]||""};return["x-upyun-file-type","x-upyun-file-size","x-upyun-file-date"].forEach(function(t){var e=t.split("x-upyun-file-")[1];r[t]&&(n[e]=r[t],"size"!==e&&"date"!==e||(n[e]=parseInt(n[e],10)))}),Promise.resolve(n)})}},{key:"deleteFile",value:function(t){var e={};return 1<arguments.length&&void 0!==arguments[1]&&arguments[1]&&(e["x-upyun-async"]=!0),this.req.delete(t,{headers:e}).then(function(t){var e=t.status;return Promise.resolve(200===e)})}},{key:"deleteDir",value:function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.deleteFile.apply(this,e)}},{key:"getFile",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if(e&&s)throw new Error("upyun - save as stream are only available on the server side.");return this.req({method:"GET",url:t,responseType:e?"stream":null}).then(function(t){if(404===t.status)return Promise.resolve(!1);if(!e)return Promise.resolve(t.data);var r=t.data.pipe(e);return new Promise(function(t,e){r.on("finish",function(){return t(r)}),r.on("error",e)})})}},{key:"updateMetadata",value:function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"merge",n={};for(var o in e)Y(o)?n[o]=e:n["x-upyun-meta-"+o]=e[o];return this.req.patch(t+"?metadata="+r,null,{headers:n}).then(function(t){var e=t.status;return Promise.resolve(200===e)})}},{key:"getMetadata",value:function(t){return this.req.get(t).then(function(t){var e=t.headers;if(200!==t.status)return Promise.resolve(!1);var r={};for(var n in e)Y(n)&&(r[n]=e[n]);return Promise.resolve(r)})}},{key:"blockUpload",value:function(h,l){var c=this,t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},e=void 0,r=void 0;return r=s?(e=Promise.resolve(l.size),l.type):(e=g.getFileSizeAsync(l),g.getContentType(l)),e.then(function(a){Object.assign(t,{"x-upyun-multi-stage":"initiate","x-upyun-multi-length":a,"x-upyun-multi-type":r});var s=1048576,u=Math.ceil(a/s);return c.req.put(h,null,{headers:t}).then(function(t){for(var e=t.headers,n=e["x-upyun-multi-uuid"],r=e["x-upyun-next-part-id"],o=Promise.resolve(r),i=0;i<u;i++)o=o.then(function(r){var t=r*s,e=Math.min(t+s,a);return g.readBlockAsync(l,t,e).then(function(t){return c.req.put(h,t,{headers:{"x-upyun-multi-stage":"upload","x-upyun-multi-uuid":n,"x-upyun-part-id":r}}).then(function(t){var e=t.headers;return r=e["x-upyun-next-part-id"],Promise.resolve(r)})})});return o.then(function(){return c.req.put(h,null,{headers:{"x-upyun-multi-stage":"complete","x-upyun-multi-uuid":n}}).then(function(t){var e=t.status;return Promise.resolve(204===e||201===e)})})})})}},{key:"formPutFile",value:function(t,e){var r=this,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},o={},i=!0,a=!1,s=void 0;try{for(var u,h=Object.keys(n)[Symbol.iterator]();!(i=(u=h.next()).done);i=!0){var l=u.value;o[l.toLowerCase()]=n[l]}}catch(t){a=!0,s=t}finally{try{!i&&h.return&&h.return()}finally{if(a)throw s}}if("function"!=typeof this.bodySignCallback)throw new Error("upyun - must setBodySignCallback first!");o.service=this.service.serviceName,o["save-key"]=t;var c=this.bodySignCallback(this.service,o);return(c=p(c)?c:Promise.resolve(c)).then(function(t){return function(t,e,r){var n=r.authorization,o=r.policy,i=new FormData;return i.append("authorization",n),i.append("policy",o),"string"==typeof e&&(e=new Blob([e],{type:"text/plain"})),i.append("file",e),f.post(t,i).then(function(t){var e=t.status,r=t.data;return 200===e&&Promise.resolve(r)})}(r.endpoint+"/"+o.service,e,t)})}},{key:"purge",value:function(t){"string"==typeof t&&(t=[t]);var e=T.getPurgeHeaderSign(this.service,t);return f.post("http://purge.upyun.com/purge/","purge="+t.join("\n"),{headers:e,proxy:this.proxy}).then(function(t){var e=t.data;if(0===Object.keys(e.invalid_domain_of_url).length)return!0;throw new Error("some url purge failed "+e.invalid_domain_of_url.join(" "))},function(t){throw new Error("upyun - request failed: "+t.message)})}}]),W),sign:T,Bucket:X,Service:X}});